{"id":"oep-2cxaz8","title":"Auto-generate AGENTS.md via genie","description":"## Problem\nAGENTS.md files need to be manually maintained across packages. They often become stale or inconsistent with actual package capabilities.\n\n## Current State\n- AGENTS.md files exist in some packages but not all\n- Content is manually written and may drift from reality\n- No automated generation or validation\n\n## Open Questions\n- What should be auto-generated vs manually curated?\n- Should it pull from package.json, README, or code analysis?\n- How to handle package-specific vs workspace-wide info?\n\n## Possible Directions\n1. **Template-based**: Genie generates from .genie.ts metadata\n2. **Code analysis**: Extract exports, commands, types automatically\n3. **Hybrid**: Auto-generate structure, allow manual sections\n4. **Validation only**: Lint existing AGENTS.md for staleness\n\n## Notes\nKeep this issue open for further exploration. The right approach depends on:\n- How much structure AGENTS.md should have\n- Whether LLMs benefit more from generated or curated content\n- Integration with existing genie workflow","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.908Z","updated_at":"2026-01-20T18:35:01.152959+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-2"}
{"id":"oep-2dh2y1","title":"Improve binary version checking discoverability in mono","description":"## Problem\nThe `mono nix status` command exists to check binary staleness, but it's not discoverable and users don't know when their CLIs need rebuilding.\n\n## Current State\n- `mono nix status` checks if built CLIs match current source\n- Uses `cli-build-stamp.nix` to compare git hashes\n- No proactive warnings when binaries are stale\n- Documentation is scattered across multiple locations\n\n## Technical Details\nThe staleness check works by:\n1. Recording git commit hash at build time in a stamp file\n2. Comparing stamp to current HEAD on status check\n3. Reporting which CLIs are out of date\n\nCurrent invocation:\n```bash\nmono nix status  # Manual check, no auto-trigger\n```\n\n## Proposed Solution\nAdd proactive staleness warnings:\n\n1. **Shell hook approach**: Check on devenv entry\n```nix\nenterShell = ''\n  if ! mono nix status --quiet; then\n    echo \"⚠️  Some CLIs are stale. Run 'mono nix rebuild' to update.\"\n  fi\n'';\n```\n\n2. **CLI integration**: Add `--check-stale` to mono commands\n3. **Help text**: Add `mono nix` to `mono --help` output prominently\n\n## Files to Modify\n- `packages/@anthropic/mono-cli/src/commands/nix.ts` (add --quiet flag)\n- `devenv.nix` (add shell hook)\n- `README.md` or `AGENTS.md` (document workflow)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.902Z","updated_at":"2026-01-20T18:34:49.804794+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-7"}
{"id":"oep-2r6jc7","title":"Add worktree support to dotdot","description":"## Problem\nDotdot lacks support for git worktrees, making it difficult to work on multiple branches simultaneously in a megarepo setup.\n\n## Current State\n- PR #63 (effect-utils) adds some worktree infrastructure to megarepo\n- The `isolate` and `unisolate` commands are NOT yet implemented\n- Basic worktree listing may exist but full workflow support is missing\n\n## Technical Details\nGit worktrees allow checking out multiple branches simultaneously:\n```bash\ngit worktree add ../feature-branch feature-branch\n# Work in ../feature-branch while main stays in original dir\n```\n\nFor megarepos, worktrees need special handling:\n1. Shared node_modules strategies (symlinks vs separate installs)\n2. Build artifact isolation\n3. Config file handling (some should be shared, some isolated)\n\n## Proposed Solution\n1. Implement `dotdot worktree add \u003cbranch\u003e` command\n2. Add `dotdot worktree list` to show active worktrees\n3. Handle node_modules: option for shared (symlink) or isolated\n4. Integrate with existing dotdot workspace detection\n\n## Related Issues\n- oep-ejolnc: Package conflicts with worktrees (dependency)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.291Z","updated_at":"2026-01-20T18:34:06.818167+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-11"}
{"id":"oep-34h1tl","title":"Improve binary version checking discoverability in mono","description":"mono nix status exists and shows binary/source version comparison, but could be more discoverable. Consider adding hints to other commands.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.902Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-7","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-3629qf","title":"Add fish autocompletions for mono","description":"Fish auto complete for mono commands including mono nix build etc","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.821Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-9","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-5hhhgu","title":"Handle package conflicts with worktrees","description":"Overlapping exposed packages pose a conflict with worktrees. Depends on worktree support.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.069Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-10","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-5y1z1l","title":"Refactor genie relative path handling","description":"Embrace dotdot workspace root. Genie generators get ctx (including package location), should embrace that (e.g. use placeholder symbols for replacement or allow callbacks for less magic).","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.489Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-5","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-aa846g","title":"Add worktree support to dotdot","description":"Use worktrees for each repo with canonical path \\~/worktrees/repo-name. Add warning to status if not using worktrees.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.291Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-11","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-aq6m32","title":"Auto-generate AGENTS.md via genie","description":"Flow to generate [AGENTS.md](http://AGENTS.md) file including:\n\n* dotdot integration\n* tasks flow\n* Where to find common things (skills, shared libs, references like effect)\n* Handle tension: running agent in sub dir for scope vs access to whole workspace for context","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.908Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-2","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-bswvo1","title":"Add VSCode workspace file generator to dotdot","description":"Command to generate .code-workspace files for the workspace","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.291Z","updated_at":"2026-01-20T17:56:41.932608+01:00","closed_at":"2026-01-20T17:56:41.932608+01:00","close_reason":"Covered by https://github.com/overengineeringstudio/effect-utils/pull/63","external_ref":"https://linear.app/overengineering/issue/OEP-4"}
{"id":"oep-ejolnc","title":"Handle package conflicts with worktrees","description":"## Problem\nWhen using git worktrees in a megarepo, package version conflicts can arise between the main checkout and worktree checkouts.\n\n## Current State\n- No conflict detection exists for worktree scenarios\n- Each worktree may have different dependency versions\n- Shared node_modules can cause subtle runtime errors\n\n## Technical Details\nConflict scenarios:\n1. Main has `lodash@4.17.21`, worktree branch has `lodash@4.17.20`\n2. Shared node_modules uses whichever was installed last\n3. Type definitions may mismatch at build time\n4. Runtime behavior differs from expected\n\n## Proposed Solution\n1. Add `dotdot worktree check` to detect version conflicts\n2. Compare package.json/bun.lock across worktrees\n3. Warn when shared dependencies have version mismatches\n4. Suggest isolation strategy when conflicts detected\n\n## Implementation Notes\n- Parse bun.lock from each worktree\n- Build dependency version map per worktree\n- Diff maps to find conflicts\n- Consider lock file hash comparison for quick check\n\n## Depends On\n- oep-2r6jc7: Basic worktree support must exist first","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.069Z","updated_at":"2026-01-20T18:34:07.106933+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-10"}
{"id":"oep-f34o99","title":"Refactor genie relative path handling","description":"## Problem\nGenie's relative path handling is CWD-dependent and uses hardcoded assumptions, leading to inconsistent behavior when run from different directories.\n\n## Current State\n- Location semantics depend on current working directory\n- Hardcoded `file:packages/` prefix in dependency resolution\n- `computeRelativePath` function is duplicated across generators\n- Path computation differs between package.json and tsconfig generators\n\n## Technical Details\nExample of CWD-dependency:\n```typescript\n// In packages/@overeng/genie/src/generators/package-json.ts\nconst relativePath = computeRelativePath(fromPackage, toPackage);\n// Returns different results based on process.cwd()\n```\n\nHardcoded prefix issue:\n```typescript\n// Assumes all packages are in packages/ directory\nconst depPath = `file:packages/${depName}`;\n// Breaks for packages in other locations (e.g., apps/, tools/)\n```\n\n## Proposed Solution\n1. **Centralize path computation**: Single `PathResolver` class\n2. **Remove CWD dependency**: Use config file location as anchor\n3. **Dynamic prefix**: Derive from actual package locations, not hardcoded\n4. **Add tests**: Cover various directory structures\n\n## Files to Modify\n- `packages/@overeng/genie/src/utils/path-resolver.ts` (new)\n- `packages/@overeng/genie/src/generators/package-json.ts`\n- `packages/@overeng/genie/src/generators/tsconfig.ts`\n- Add integration tests with different CWDs","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.489Z","updated_at":"2026-01-20T18:34:50.383506+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-5"}
{"id":"oep-f8jtec","title":"Add devenv/direnv local fish autocomplete loading","description":"## Problem\nFish autocompletions for workspace-local CLIs (mono, genie, dotdot) aren't loaded when entering a devenv shell. Users must manually source completions.\n\n## Current State\n- CLIs support `--completions fish` but output isn't auto-loaded\n- devenv's `enterShell` could generate and source completions\n- No existing pattern for devenv-integrated completion loading\n\n## Technical Details\nFish loads completions from:\n1. `~/.config/fish/completions/` (user-global)\n2. `/nix/store/.../share/fish/vendor_completions.d/` (nix packages)\n3. Dynamically via `source` in shell init\n\nFor devenv, completions should be:\n- Generated on shell entry (to match current CLI version)\n- Sourced automatically without user action\n- Isolated per-project (don't pollute global completions)\n\n## Proposed Solution\nCreate a `fish-completion-sync` devenv plugin:\n```nix\n# In devenv.nix\nenterShell = ''\n  # Generate completions for workspace CLIs\n  mono --completions fish | source\n  genie --completions fish | source\n  dotdot --completions fish | source\n'';\n```\n\nOr create a reusable module:\n```nix\nimports = [ inputs.effect-utils.devenvModules.fish-completions ];\nfish-completions.commands = [ \"mono\" \"genie\" \"dotdot\" ];\n```\n\n## Files to Create\n- `nix/devenv-modules/fish-completions.nix`\n- Update effect-utils flake to export module","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.419Z","updated_at":"2026-01-20T18:34:49.49262+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-8"}
{"id":"oep-jdm41l","title":"Add VSCode workspace file generator to dotdot","description":"Command to generate .code-workspace files for the workspace","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.291Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-4","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-oz6hk2","title":"Fix patches feature propagation in genie","description":"## Problem\nGenie's patches feature doesn't propagate through the dependency graph like `peerDependencies` does. When a package defines patches, consuming packages don't automatically inherit them.\n\n## Current State\n- `peerDependencies` correctly propagates via `meta.data.peerDependencies` in generated configs\n- `patches` are defined in `.genie.ts` but only applied to the defining package\n- No `.data.patches` export pattern exists for propagation\n\n## Technical Details\nIn genie configs:\n```typescript\n// Package A defines patches\nexport const config = definePackage({\n  patches: { 'some-dep': './patches/fix.patch' }\n})\n\n// Package B depends on A but doesn't get A's patches\nexport const config = definePackage({\n  dependencies: ['@scope/package-a']\n})\n```\n\n## Proposed Solution\nImplement patch propagation similar to peerDependencies:\n1. Add `.data.patches` export to generated configs\n2. Collect patches from transitive dependencies during generation\n3. Merge patches with conflict detection (same dep, different patches)\n4. Apply merged patches in consuming package's config\n\n## Files to Modify\n- `packages/@overeng/genie/src/generators/package-json.ts`\n- `packages/@overeng/genie/src/types.ts` (add patches to metadata)\n- Add tests for patch propagation scenarios","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.742Z","updated_at":"2026-01-20T18:34:06.524886+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-1"}
{"id":"oep-pi6apd","title":"Add bun.lock freshness check to mono check","description":"Add to mono check that bun lock files are up to date and devenv builds","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.106Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-3","comments":[{"id":1,"issue_id":"oep-pi6apd","author":"Johannes Schickling","text":"Commit bdc2da4 in beads-test-project: Test hook (eu-pi6apd)","created_at":"2026-01-19T13:30:01Z"}],"deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-sjyy41","title":"Streamline binary rebuild workflow documentation","description":"mono nix build/hash/reload workflow exists but could use better docs/UX. Document the full workflow clearly.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.662Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-6","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-taj25k","title":"Add bun.lock freshness check to mono check","description":"## Problem\nThe `bun.lock` file can become stale when local `file:` dependencies are modified but `bun install` isn't re-run. This causes silent build failures and confusing errors.\n\n## Current State\n- A bash-based staleness check exists in `dotfiles/nixpkgs/home-manager/modules/direnv-stale-check/`\n- It uses git commit ancestry (`git merge-base --is-ancestor`) to detect if dependencies changed\n- The check runs via direnv shell hook, not integrated into `mono check`\n\n## Technical Details\nThe check works by:\n1. Parsing `bun.lock` JSONL format for `file:` dependencies with commit hashes\n2. For each local dep, verifying if the recorded commit is an ancestor of current HEAD\n3. Warning if any dependency's commit is not in the current history\n\n## Proposed Solution\nPort the staleness check to TypeScript as an Effect-based task in `mono check`:\n1. Create `packages/@anthropic/mono-cli/src/tasks/bun-lock-freshness.ts`\n2. Implement as `Effect.gen` task matching existing task patterns\n3. Parse bun.lock, extract file: deps, run git ancestry checks\n4. Integrate into `mono check` task runner\n\n## Files to Modify\n- `packages/@anthropic/mono-cli/src/tasks/bun-lock-freshness.ts` (new)\n- `packages/@anthropic/mono-cli/src/commands/check.ts` (add task)\n- Reference: `dotfiles/nixpkgs/home-manager/modules/direnv-stale-check/default.nix`","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.106Z","updated_at":"2026-01-20T18:34:06.195287+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-3"}
{"id":"oep-w2es9r","title":"Streamline binary rebuild workflow documentation","description":"## Problem\nThe workflow for rebuilding stale binaries is undocumented and scattered. Users don't know the full rebuild cycle.\n\n## Current State\n- `mono nix status` - check staleness (exists)\n- `mono nix rebuild` - rebuild CLIs (exists, undocumented)\n- `direnv reload` - reload shell with new binaries (manual step)\n- No single source of truth for the workflow\n\n## Technical Details\nFull rebuild workflow:\n```bash\n# 1. Check what's stale\nmono nix status\n\n# 2. Rebuild stale CLIs\nmono nix rebuild\n\n# 3. Reload shell to pick up new binaries\ndirenv reload\n# or: exit and re-enter directory\n```\n\nThe workflow is non-obvious because:\n- `rebuild` updates Nix store but shell has old PATH\n- Users expect rebuild to \"just work\" without reload\n- No feedback about needing to reload\n\n## Proposed Solution\n1. **Consolidate docs**: Add \"Binary Management\" section to AGENTS.md\n2. **Improve UX**: After rebuild, print reminder to reload shell\n3. **Consider automation**: `mono nix rebuild --reload` that triggers direnv\n\n## Documentation to Add\n```markdown\n## Binary Management\n\nCheck if CLIs need rebuilding:\n```bash\nmono nix status\n```\n\nRebuild stale CLIs:\n```bash\nmono nix rebuild \u0026\u0026 direnv reload\n```\n```\n\n## Related Issues\n- oep-2dh2y1: Discoverability (complementary)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.662Z","updated_at":"2026-01-20T18:34:50.094765+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-6"}
{"id":"oep-wjtz6m","title":"Add devenv/direnv local fish autocomplete loading","description":"Load fish autocompletions from devenv/direnv. Depends on fish autocomplete support.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.419Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-8","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-x2sjpj","title":"Add fish autocompletions for mono","description":"## Problem\nThe `mono` CLI lacks fish shell autocompletions, making it harder to discover and use commands efficiently.\n\n## Current State\n- `mono`, `genie`, and `dotdot` CLIs all support `--completions fish` flag\n- Running `mono --completions fish` outputs valid fish completion script\n- Completions are not installed by default in the devenv shell\n\n## Technical Details\nThe CLIs use a common completion generation pattern:\n```bash\nmono --completions fish \u003e ~/.config/fish/completions/mono.fish\ngenie --completions fish \u003e ~/.config/fish/completions/genie.fish\ndotdot --completions fish \u003e ~/.config/fish/completions/dotdot.fish\n```\n\n## Proposed Solution\n1. Add completion generation to the Nix build for each CLI\n2. Use `pkgs.runCommand` pattern (like bd completions in fish.nix)\n3. Install completions to appropriate location via home-manager\n\n## Example Implementation\n```nix\nmonoFishCompletions = pkgs.runCommand \"mono-fish-completions\" { } ''\n  ${mono}/bin/mono --completions fish \u003e $out\n'';\n```\n\n## Related Issues\n- oep-f8jtec: Devenv-local completion loading (complementary approach)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.821Z","updated_at":"2026-01-20T18:34:49.171217+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-9"}
{"id":"oep-xsxys3","title":"Fix patches feature propagation in genie","description":"Currently no good way to enforce dependents of a package with patches to also have patches in their package.json.genie.ts. Blocked by bun bug.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.742Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-1","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
