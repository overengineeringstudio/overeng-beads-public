{"id":"oep-01j397","title":"Phase out mono CLI in favor of devenv tasks","description":"## Goal\n\nMigrate from custom `mono` CLI commands to native devenv tasks, following the pattern already established in effect-utils.\n\n## Current State in effect-utils\n\neffect-utils has already migrated most mono commands to devenv tasks (see `scripts/mono.ts`):\n\n```\n# Old mono commands → New devenv tasks\nmono bun install    → dt bun:install\nmono genie          → dt genie:run / genie:watch / genie:check\nmono ts             → dt ts:check / ts:watch / ts:build / ts:clean\nmono lint           → dt lint:check / lint:fix\nmono test           → dt test:run / test:watch / test:unit / test:integration\nmono check          → dt check:quick / check:all\n```\n\nOnly `mono nix` and `mono context` remain as CLI commands.\n\n## Why Migrate\n\n### Benefits of devenv tasks over mono CLI:\n\n1. **Native tooling** - `devenv tasks list`, `dt \u003ctask\u003e`\n2. **Dependency ordering** - `after = [\"deps\"]` built-in\n3. **Idempotency** - `status` checks skip unnecessary work\n4. **Automatic execution** - `before = [\"devenv:enterShell\"]`\n5. **No custom CLI maintenance** - less code to maintain\n6. **Discoverable** - `devenv tasks list` shows all available tasks\n7. **Composable** - tasks can depend on each other\n\n### What mono CLI still provides:\n\n* `mono nix status/rebuild` - CLI staleness checking\n* `mono context` - workspace context info\n* Complex orchestration that doesn't fit task model\n\n## Migration Plan\n\n### Phase 1: Audit mono commands across repos\n\n- [ ] List all mono subcommands in livestore\n- [ ] List all mono subcommands in other repos\n- [ ] Identify which map cleanly to devenv tasks\n\n### Phase 2: Create devenv task equivalents\n\nFor each command, create task with:\n\n```nix\ntasks.\"category:action\" = {\n  exec = \"...\";\n  status = \"...\";  # Optional: skip if already done\n  after = [...];   # Optional: dependencies\n};\n```\n\n### Phase 3: Deprecate mono commands\n\n* Add deprecation warnings pointing to devenv tasks\n* Update documentation\n* Eventually remove from mono CLI\n\n## Task Naming Convention (from effect-utils)\n\n```\nbun:install\ngenie:run | genie:watch | genie:check\nts:check | ts:watch | ts:build | ts:clean  \nlint:check | lint:fix\ntest:run | test:watch | test:unit | test:integration\ncheck:quick | check:all\n```\n\n## Related Issues\n\n* oep-6nt: Automatic repo setup via devenv tasks (uses same pattern)\n\n## Files\n\n* `effect-utils/scripts/mono.ts` - reference implementation\n* `effect-utils/devenv.nix` - task definitions\n* `livestore/devenv.nix` - needs task migration","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-28T10:42:14.564246+01:00","updated_at":"2026-01-28T10:42:14.564246+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-13"}
{"id":"oep-1n7vgy","title":"bake `oxfmt` as fallback into `genie` bin to avoid formatting churn.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-28T10:42:14.564246+01:00","updated_at":"2026-01-28T10:42:14.564246+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-14"}
{"id":"oep-2cxaz8","title":"Auto-generate AGENTS.md via genie","description":"## Problem\n\n[AGENTS.md](\u003chttp://AGENTS.md\u003e) files need to be manually maintained across packages. They often become stale or inconsistent with actual package capabilities.\n\n## Current State\n\n* [AGENTS.md](\u003chttp://AGENTS.md\u003e) files exist in some packages but not all\n* Content is manually written and may drift from reality\n* No automated generation or validation\n\n## Open Questions\n\n* What should be auto-generated vs manually curated?\n* Should it pull from package.json, README, or code analysis?\n* How to handle package-specific vs workspace-wide info?\n\n## Possible Directions\n\n1. **Template-based**: Genie generates from .genie.ts metadata\n2. **Code analysis**: Extract exports, commands, types automatically\n3. **Hybrid**: Auto-generate structure, allow manual sections\n4. **Validation only**: Lint existing [AGENTS.md](\u003chttp://AGENTS.md\u003e) for staleness\n\n## Notes\n\nKeep this issue open for further exploration. The right approach depends on:\n\n* How much structure [AGENTS.md](\u003chttp://AGENTS.md\u003e) should have\n* Whether LLMs benefit more from generated or curated content\n* Integration with existing genie workflow","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.908Z","updated_at":"2026-01-28T10:42:14.56424+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-2"}
{"id":"oep-2dh2y1","title":"Improve binary version checking discoverability in mono","description":"## Problem\n\nThe `mono nix status` command exists to check binary staleness, but it's not discoverable and users don't know when their CLIs need rebuilding.\n\n## Current State\n\n* `mono nix status` checks if built CLIs match current source\n* Uses `cli-build-stamp.nix` to compare git hashes\n* No proactive warnings when binaries are stale\n* Documentation is scattered across multiple locations\n\n## Technical Details\n\nThe staleness check works by:\n\n1. Recording git commit hash at build time in a stamp file\n2. Comparing stamp to current HEAD on status check\n3. Reporting which CLIs are out of date\n\nCurrent invocation:\n\n```bash\nmono nix status  # Manual check, no auto-trigger\n```\n\n## Proposed Solution\n\nAdd proactive staleness warnings:\n\n1. **Shell hook approach**: Check on devenv entry\n\n```nix\nenterShell = ''\n  if ! mono nix status --quiet; then\n    echo \"⚠️  Some CLIs are stale. Run 'mono nix rebuild' to update.\"\n  fi\n'';\n```\n\n2. **CLI integration**: Add `--check-stale` to mono commands\n3. **Help text**: Add `mono nix` to `mono --help` output prominently\n\n## Files to Modify\n\n* `packages/@anthropic/mono-cli/src/commands/nix.ts` (add --quiet flag)\n* `devenv.nix` (add shell hook)\n* `README.md` or `AGENTS.md` (document workflow)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.902Z","updated_at":"2026-01-28T10:42:14.56423+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-7"}
{"id":"oep-2r6jc7","title":"Add worktree support to dotdot","description":"## Problem\n\nDotdot lacks support for git worktrees, making it difficult to work on multiple branches simultaneously in a megarepo setup.\n\n## Current State\n\n* PR #63 (effect-utils) adds some worktree infrastructure to megarepo\n* The `isolate` and `unisolate` commands are NOT yet implemented\n* Basic worktree listing may exist but full workflow support is missing\n\n## Technical Details\n\nGit worktrees allow checking out multiple branches simultaneously:\n\n```bash\ngit worktree add ../feature-branch feature-branch\n# Work in ../feature-branch while main stays in original dir\n```\n\nFor megarepos, worktrees need special handling:\n\n1. Shared node_modules strategies (symlinks vs separate installs)\n2. Build artifact isolation\n3. Config file handling (some should be shared, some isolated)\n\n## Proposed Solution\n\n1. Implement `dotdot worktree add \u003cbranch\u003e` command\n2. Add `dotdot worktree list` to show active worktrees\n3. Handle node_modules: option for shared (symlink) or isolated\n4. Integrate with existing dotdot workspace detection\n\n## Related Issues\n\n* oep-ejolnc: Package conflicts with worktrees (dependency)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.291Z","updated_at":"2026-01-28T10:42:14.564221+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-11"}
{"id":"oep-34h1tl","title":"Improve binary version checking discoverability in mono","description":"mono nix status exists and shows binary/source version comparison, but could be more discoverable. Consider adding hints to other commands.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.902Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-7","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-3629qf","title":"Add fish autocompletions for mono","description":"Fish auto complete for mono commands including mono nix build etc","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.821Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-9","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-3630","title":"mr sync doesn't update megarepo root's flake.lock","description":"mr sync updates megarepo.lock correctly, but the Nix lock sync feature only processes flake.lock files inside member directories (e.g., repos/effect-utils/), not the megarepo root's own flake.lock.\n\nWhen effect-utils is updated and pushed, running 'mr sync' in dotfiles updates megarepo.lock to the new commit, but flake.lock still points to the old GitHub revision. Users must manually run 'nix flake lock --update-input effect-utils' to update.\n\nThe nix-lock sync code (nix-lock/mod.ts) iterates over members and looks for flake.lock inside member directories, but the megarepo root's flake.lock is outside this scope.","status":"open","priority":2,"issue_type":"bug","owner":"schickling.j@gmail.com","created_at":"2026-01-28T10:38:28.152211+01:00","created_by":"Johannes Schickling","updated_at":"2026-01-28T10:42:14.947629+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-16"}
{"id":"oep-3631","title":"dt nix:hash fails to auto-fix when pnpm offline install fails","description":"dt nix:hash:megarepo (and similar tasks) fail to automatically update the hash when the pnpm lockfile has changed but the hash itself hasn't triggered a mismatch.\n\nThe task looks for 'got: sha256-...' hash mismatch errors in the build output. But when the pnpmDepsHash points to a valid (but outdated) store, pnpm fails with ERR_PNPM_NO_OFFLINE_TARBALL instead of a hash mismatch.\n\nError seen:\n  ERR_PNPM_NO_OFFLINE_TARBALL  A package is missing from the store but cannot download it in offline mode.\n\nThe task reports: 'build failed but no hash mismatch found' and gives up.\n\nWorkaround: Manually set a fake hash (sha256-AAA...) to force a hash mismatch, which reveals the correct hash.\n\nSuggested fix: Detect ERR_PNPM_NO_OFFLINE_TARBALL errors and automatically try the fake-hash trick, or add a --force flag.","status":"open","priority":2,"issue_type":"bug","owner":"schickling.j@gmail.com","created_at":"2026-01-28T10:38:40.982313+01:00","created_by":"Johannes Schickling","updated_at":"2026-01-28T10:42:14.799144+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-15"}
{"id":"oep-3632","title":"Enable remaining type-aware oxlint rules","description":"We enabled type-aware linting with oxlint to catch @deprecated usage via the typescript/no-deprecated rule.\n\nHowever, to avoid a large initial cleanup, we disabled the other type-aware rules with TODO comments in genie/oxlint-base.ts. These should be re-enabled incrementally:\n\nRules to enable (by occurrence count):\n- typescript/no-unsafe-type-assertion (325) - warns about unsafe type assertions\n- typescript/no-unnecessary-type-arguments (54) - detects unnecessary type arguments\n- typescript/no-unnecessary-type-assertion (48) - detects unnecessary type assertions\n- typescript/no-unnecessary-boolean-literal-compare (46) - detects unnecessary boolean comparisons\n- typescript/no-misused-spread (18) - detects misused spread operators\n- typescript/no-redundant-type-constituents (12) - detects redundant type constituents\n- typescript/no-floating-promises (9) - detects floating promises\n- typescript/no-base-to-string (6) - detects improper toString usage\n- typescript/no-unsafe-enum-comparison (5) - detects unsafe enum comparisons\n- typescript/unbound-method (4) - detects unbound methods\n- typescript/restrict-template-expressions (3) - restricts template expression types\n- typescript/no-duplicate-type-constituents (3) - detects duplicate type constituents\n- typescript/no-unsafe-unary-minus (1) - detects unsafe unary minus\n- typescript/no-unnecessary-template-expression (1) - detects unnecessary template expressions\n\nApproach:\n1. Pick a rule with low occurrence count\n2. Enable it in genie/oxlint-base.ts\n3. Run dt genie:run \u0026\u0026 dt lint:check\n4. Fix the violations\n5. Repeat\n\nFiles:\n- genie/oxlint-base.ts - Rule configuration\n- nix/devenv-modules/tasks/shared/lint-oxc.nix - Type-aware lint task config\n- devenv.nix - tsconfig and tsgolint package config","status":"open","priority":2,"issue_type":"task","owner":"schickling.j@gmail.com","created_at":"2026-02-01T11:18:25.03093+01:00","created_by":"Johannes Schickling","updated_at":"2026-02-01T11:18:25.03093+01:00","labels":["pkg:infra","pkg:oxc-config","size:medium"]}
{"id":"oep-3a1","title":"Commit and push devenv.lock update (effect-utils upgrade)","description":"type: task","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-06T22:06:40.351120307+01:00","updated_at":"2026-02-06T22:09:58.248833217+01:00","closed_at":"2026-02-06T22:09:58.248833217+01:00","close_reason":"Committed in 369dd845a: devenv.lock, megarepo.lock, ci.yml quoting","dependencies":[{"issue_id":"oep-3a1","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.812379683+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-3d9","title":"Fix genie generation failure (118 files)","description":"type: bug","status":"open","priority":1,"issue_type":"bug","created_at":"2026-02-06T22:06:40.347138385+01:00","updated_at":"2026-02-06T22:07:01.88233013+01:00","dependencies":[{"issue_id":"oep-3d9","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.095116411+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-5hhhgu","title":"Handle package conflicts with worktrees","description":"Overlapping exposed packages pose a conflict with worktrees. Depends on worktree support.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.069Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-10","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-5y1z1l","title":"Refactor genie relative path handling","description":"Embrace dotdot workspace root. Genie generators get ctx (including package location), should embrace that (e.g. use placeholder symbols for replacement or allow callbacks for less magic).","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.489Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-5","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-76g","title":"Diff CI test results against dev branch","description":"type: task","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-06T22:06:40.349581857+01:00","updated_at":"2026-02-06T22:07:02.306850766+01:00","dependencies":[{"issue_id":"oep-76g","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.529931007+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-8fr","title":"Fix lint CI job (dt lint:full)","description":"type: bug","status":"open","priority":1,"issue_type":"bug","created_at":"2026-02-06T22:06:40.347723242+01:00","updated_at":"2026-02-06T22:07:01.953698038+01:00","dependencies":[{"issue_id":"oep-8fr","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.166481684+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-9vu","title":"Fix Cloudflare deploy in examples CI","description":"type: bug","status":"open","priority":2,"issue_type":"bug","created_at":"2026-02-06T22:06:40.348104473+01:00","updated_at":"2026-02-06T22:07:02.022029994+01:00","dependencies":[{"issue_id":"oep-9vu","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.239797927+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-aa846g","title":"Add worktree support to dotdot","description":"Use worktrees for each repo with canonical path \\~/worktrees/repo-name. Add warning to status if not using worktrees.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.291Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-11","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-abg","title":"Fix playwright integration test (vite not in PATH)","description":"type: bug","status":"open","priority":2,"issue_type":"bug","created_at":"2026-02-06T22:06:40.348468682+01:00","updated_at":"2026-02-06T22:07:02.094713331+01:00","dependencies":[{"issue_id":"oep-abg","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.312744291+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-aq6m32","title":"Auto-generate AGENTS.md via genie","description":"Flow to generate [AGENTS.md](http://AGENTS.md) file including:\n\n* dotdot integration\n* tasks flow\n* Where to find common things (skills, shared libs, references like effect)\n* Handle tension: running agent in sub dir for scope vs access to whole workspace for context","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.908Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-2","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-bbd","title":"Fix docs deploy CI job","description":"type: bug","status":"open","priority":2,"issue_type":"bug","created_at":"2026-02-06T22:06:40.348838241+01:00","updated_at":"2026-02-06T22:07:02.166248004+01:00","dependencies":[{"issue_id":"oep-bbd","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.386476482+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-bswvo1","title":"Add VSCode workspace file generator to dotdot","description":"Command to generate .code-workspace files for the workspace","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.291Z","updated_at":"2026-01-20T17:56:41.932608+01:00","closed_at":"2026-01-20T17:56:41.932608+01:00","close_reason":"Covered by https://github.com/overengineeringstudio/effect-utils/pull/63","external_ref":"https://linear.app/overengineering/issue/OEP-4"}
{"id":"oep-dfc","title":"Enable stricter oxlint rules","description":"type: task","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-06T22:06:40.350368064+01:00","updated_at":"2026-02-06T22:07:02.448732508+01:00","dependencies":[{"issue_id":"oep-dfc","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.66818644+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-e2a","title":"Complete beads setup","description":"type: task","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-06T22:06:40.350734628+01:00","updated_at":"2026-02-06T22:07:02.518693875+01:00","dependencies":[{"issue_id":"oep-e2a","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.739474156+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-ejolnc","title":"Handle package conflicts with worktrees","description":"## Problem\n\nWhen using git worktrees in a megarepo, package version conflicts can arise between the main checkout and worktree checkouts.\n\n## Current State\n\n* No conflict detection exists for worktree scenarios\n* Each worktree may have different dependency versions\n* Shared node_modules can cause subtle runtime errors\n\n## Technical Details\n\nConflict scenarios:\n\n1. Main has `lodash@4.17.21`, worktree branch has `lodash@4.17.20`\n2. Shared node_modules uses whichever was installed last\n3. Type definitions may mismatch at build time\n4. Runtime behavior differs from expected\n\n## Proposed Solution\n\n1. Add `dotdot worktree check` to detect version conflicts\n2. Compare package.json/bun.lock across worktrees\n3. Warn when shared dependencies have version mismatches\n4. Suggest isolation strategy when conflicts detected\n\n## Implementation Notes\n\n* Parse bun.lock from each worktree\n* Build dependency version map per worktree\n* Diff maps to find conflicts\n* Consider lock file hash comparison for quick check\n\n## Depends On\n\n* oep-2r6jc7: Basic worktree support must exist first","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:21.069Z","updated_at":"2026-01-28T10:42:14.564225+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-10"}
{"id":"oep-f34o99","title":"Refactor genie relative path handling","description":"## Problem\n\nGenie's relative path handling is CWD-dependent and uses hardcoded assumptions, leading to inconsistent behavior when run from different directories.\n\n## Current State\n\n* Location semantics depend on current working directory\n* Hardcoded `file:packages/` prefix in dependency resolution\n* `computeRelativePath` function is duplicated across generators\n* Path computation differs between package.json and tsconfig generators\n\n## Technical Details\n\nExample of CWD-dependency:\n\n```typescript\n// In packages/@overeng/genie/src/generators/package-json.ts\nconst relativePath = computeRelativePath(fromPackage, toPackage);\n// Returns different results based on process.cwd()\n```\n\nHardcoded prefix issue:\n\n```typescript\n// Assumes all packages are in packages/ directory\nconst depPath = `file:packages/${depName}`;\n// Breaks for packages in other locations (e.g., apps/, tools/)\n```\n\n## Proposed Solution\n\n1. **Centralize path computation**: Single `PathResolver` class\n2. **Remove CWD dependency**: Use config file location as anchor\n3. **Dynamic prefix**: Derive from actual package locations, not hardcoded\n4. **Add tests**: Cover various directory structures\n\n## Files to Modify\n\n* `packages/@overeng/genie/src/utils/path-resolver.ts` (new)\n* `packages/@overeng/genie/src/generators/package-json.ts`\n* `packages/@overeng/genie/src/generators/tsconfig.ts`\n* Add integration tests with different CWDs","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.489Z","updated_at":"2026-01-28T10:42:14.564236+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-5"}
{"id":"oep-f8jtec","title":"Add devenv/direnv local fish autocomplete loading","description":"## Problem\n\nFish autocompletions for workspace-local CLIs (mono, genie, dotdot) aren't loaded when entering a devenv shell. Users must manually source completions.\n\n## Current State\n\n* CLIs support `--completions fish` but output isn't auto-loaded\n* devenv's `enterShell` could generate and source completions\n* No existing pattern for devenv-integrated completion loading\n\n## Technical Details\n\nFish loads completions from:\n\n1. `~/.config/fish/completions/` (user-global)\n2. `/nix/store/.../share/fish/vendor_completions.d/` (nix packages)\n3. Dynamically via `source` in shell init\n\nFor devenv, completions should be:\n\n* Generated on shell entry (to match current CLI version)\n* Sourced automatically without user action\n* Isolated per-project (don't pollute global completions)\n\n## Proposed Solution\n\nCreate a `fish-completion-sync` devenv plugin:\n\n```nix\n# In devenv.nix\nenterShell = ''\n  # Generate completions for workspace CLIs\n  mono --completions fish | source\n  genie --completions fish | source\n  dotdot --completions fish | source\n'';\n```\n\nOr create a reusable module:\n\n```nix\nimports = [ inputs.effect-utils.devenvModules.fish-completions ];\nfish-completions.commands = [ \"mono\" \"genie\" \"dotdot\" ];\n```\n\n## Files to Create\n\n* `nix/devenv-modules/fish-completions.nix`\n* Update effect-utils flake to export module","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.419Z","updated_at":"2026-01-28T10:42:14.564229+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-8"}
{"id":"oep-ft13rz","title":"Automatic repo setup on clone/branch switch via devenv tasks","description":"## Goal\n\nWhen a developer clones a repo or switches branches, the workspace should automatically be ready to use - no manual setup steps required. This includes:\n\n1. **Dependencies installed** - `bun install` / `pnpm install` runs if lockfile changed\n2. **Config files generated** - `genie` runs if .genie.ts files changed\n3. **Initial build done** - `mono ts` / `tsc` runs if source changed\n\nThe developer experience should be:\n\n```bash\ngit clone \u003crepo\u003e\ncd \u003crepo\u003e\n# Shell activates, setup runs automatically\n# Ready to work immediately\n```\n\nOr after switching branches:\n\n```bash\ngit checkout feature-branch\n# direnv reloads, detects changes, runs necessary setup\n# Ready to work immediately\n```\n\n## Current State\n\nLivestore has a custom `scripts/standalone/setup.ts` that attempts this, but:\n\n* Custom hash-based caching instead of devenv's built-in mechanisms\n* Not integrated with devenv task system (not discoverable, can't re-run individually)\n* Requires bun before deps are installed (chicken-egg)\n\n## Proposed Solution\n\nUse devenv tasks with `before = [ \"devenv:enterShell\" ]` for automatic execution:\n\n```nix\ntasks.\"setup:deps\" = {\n  exec = \"pnpm install\";\n  status = \"[ -d node_modules ] \u0026\u0026 [ pnpm-lock.yaml -ot node_modules ]\";\n  before = [ \"devenv:enterShell\" ];\n};\n\ntasks.\"setup:genie\" = {\n  exec = \"genie\";\n  after = [ \"setup:deps\" ];\n  before = [ \"devenv:enterShell\" ];\n  # Or use execIfModified for .genie.ts files\n};\n\ntasks.\"setup:build\" = {\n  exec = \"mono ts\";\n  after = [ \"setup:genie\" ];\n  before = [ \"devenv:enterShell\" ];\n};\n```\n\n## Options\n\n### Option A: Inline in each repo's devenv.nix\n\nDefine tasks directly in each repo. Simple, explicit, but duplicated.\n\n### Option B: Shared devenv module in effect-utils\n\nCreate reusable module for common setup patterns:\n\n```nix\n# In repo's devenv.nix:\nimports = [\n  (inputs.effect-utils.devenvModules.workspaceSetup {\n    packageManager = \"pnpm\";  # or \"bun\"\n    genie.enable = true;\n    initialBuild = \"mono ts\";\n  })\n];\n```\n\nDRY, configurable, consistent across repos.\n\n## Key devenv features to leverage\n\n* `before = [ \"devenv:enterShell\" ]` - automatic execution on shell entry\n* `status` - skip if already done (idempotent)\n* `after` - dependency ordering between tasks\n* `execIfModified` - file-based triggers\n\n## Success Criteria\n\n- [ ] Clone repo → shell activates → ready to run tests/dev server\n- [ ] Switch branch with different deps → auto-installs on next shell entry\n- [ ] `devenv tasks list` shows available setup tasks\n- [ ] Can manually re-run: `devenv tasks run setup:deps`","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-28T10:42:14.564246+01:00","updated_at":"2026-01-28T10:42:14.564246+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-12"}
{"id":"oep-jdm41l","title":"Add VSCode workspace file generator to dotdot","description":"Command to generate .code-workspace files for the workspace","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.291Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-4","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-lp9","title":"Biome to oxfmt formatting migration (Phase 2)","description":"type: task","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-06T22:06:40.349986412+01:00","updated_at":"2026-02-06T22:07:02.378331328+01:00","dependencies":[{"issue_id":"oep-lp9","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.599584383+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-oz6hk2","title":"Fix patches feature propagation in genie","description":"## Problem\n\nGenie's patches feature doesn't propagate through the dependency graph like `peerDependencies` does. When a package defines patches, consuming packages don't automatically inherit them.\n\n## Current State\n\n* `peerDependencies` correctly propagates via `meta.data.peerDependencies` in generated configs\n* `patches` are defined in `.genie.ts` but only applied to the defining package\n* No `.data.patches` export pattern exists for propagation\n\n## Technical Details\n\nIn genie configs:\n\n```typescript\n// Package A defines patches\nexport const config = definePackage({\n  patches: { 'some-dep': './patches/fix.patch' }\n})\n\n// Package B depends on A but doesn't get A's patches\nexport const config = definePackage({\n  dependencies: ['@scope/package-a']\n})\n```\n\n## Proposed Solution\n\nImplement patch propagation similar to peerDependencies:\n\n1. Add `.data.patches` export to generated configs\n2. Collect patches from transitive dependencies during generation\n3. Merge patches with conflict detection (same dep, different patches)\n4. Apply merged patches in consuming package's config\n\n## Files to Modify\n\n* `packages/@overeng/genie/src/generators/package-json.ts`\n* `packages/@overeng/genie/src/types.ts` (add patches to metadata)\n* Add tests for patch propagation scenarios","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.742Z","updated_at":"2026-01-28T10:42:14.564242+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-1"}
{"id":"oep-p6c","title":"Investigate wa-sqlite Emscripten linker error","description":"type: bug","status":"open","priority":3,"issue_type":"bug","created_at":"2026-02-06T22:06:40.349213791+01:00","updated_at":"2026-02-06T22:07:02.236597376+01:00","dependencies":[{"issue_id":"oep-p6c","depends_on_id":"oep-zsl","type":"parent-child","created_at":"2026-02-06T22:07:01.454738325+01:00","created_by":"Johannes Schickling"}]}
{"id":"oep-pi6apd","title":"Add bun.lock freshness check to mono check","description":"Add to mono check that bun lock files are up to date and devenv builds","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.106Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-3","comments":[{"id":1,"issue_id":"oep-pi6apd","author":"Johannes Schickling","text":"Commit bdc2da4 in beads-test-project: Test hook (eu-pi6apd)","created_at":"2026-01-19T13:30:01Z"}],"deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-sjyy41","title":"Streamline binary rebuild workflow documentation","description":"mono nix build/hash/reload workflow exists but could use better docs/UX. Document the full workflow clearly.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.662Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-6","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-taj25k","title":"Add bun.lock freshness check to mono check","description":"## Problem\n\nThe `bun.lock` file can become stale when local `file:` dependencies are modified but `bun install` isn't re-run. This causes silent build failures and confusing errors.\n\n## Current State\n\n* A bash-based staleness check exists in `dotfiles/nixpkgs/home-manager/modules/direnv-stale-check/`\n* It uses git commit ancestry (`git merge-base --is-ancestor`) to detect if dependencies changed\n* The check runs via direnv shell hook, not integrated into `mono check`\n\n## Technical Details\n\nThe check works by:\n\n1. Parsing `bun.lock` JSONL format for `file:` dependencies with commit hashes\n2. For each local dep, verifying if the recorded commit is an ancestor of current HEAD\n3. Warning if any dependency's commit is not in the current history\n\n## Proposed Solution\n\nPort the staleness check to TypeScript as an Effect-based task in `mono check`:\n\n1. Create `packages/@anthropic/mono-cli/src/tasks/bun-lock-freshness.ts`\n2. Implement as `Effect.gen` task matching existing task patterns\n3. Parse bun.lock, extract file: deps, run git ancestry checks\n4. Integrate into `mono check` task runner\n\n## Files to Modify\n\n* `packages/@anthropic/mono-cli/src/tasks/bun-lock-freshness.ts` (new)\n* `packages/@anthropic/mono-cli/src/commands/check.ts` (add task)\n* Reference: `dotfiles/nixpkgs/home-manager/modules/direnv-stale-check/default.nix`","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:19.106Z","updated_at":"2026-01-28T10:42:14.564239+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-3"}
{"id":"oep-w2es9r","title":"Streamline binary rebuild workflow documentation","description":"## Problem\n\nThe workflow for rebuilding stale binaries is undocumented and scattered. Users don't know the full rebuild cycle.\n\n## Current State\n\n* `mono nix status` - check staleness (exists)\n* `mono nix rebuild` - rebuild CLIs (exists, undocumented)\n* `direnv reload` - reload shell with new binaries (manual step)\n* No single source of truth for the workflow\n\n## Technical Details\n\nFull rebuild workflow:\n\n```bash\n# 1. Check what's stale\nmono nix status\n\n# 2. Rebuild stale CLIs\nmono nix rebuild\n\n# 3. Reload shell to pick up new binaries\ndirenv reload\n# or: exit and re-enter directory\n```\n\nThe workflow is non-obvious because:\n\n* `rebuild` updates Nix store but shell has old PATH\n* Users expect rebuild to \"just work\" without reload\n* No feedback about needing to reload\n\n## Proposed Solution\n\n1. **Consolidate docs**: Add \"Binary Management\" section to [AGENTS.md](\u003chttp://AGENTS.md\u003e)\n2. **Improve UX**: After rebuild, print reminder to reload shell\n3. **Consider automation**: `mono nix rebuild --reload` that triggers direnv\n\n## Documentation to Add\n\n```markdown\n## Binary Management\n\nCheck if CLIs need rebuilding:\n```bash\nmono nix status\n```\n\nRebuild stale CLIs:\n\n```bash\nmono nix rebuild \u0026\u0026 direnv reload\n```\n\n```\n\n## Related Issues\n- oep-2dh2y1: Discoverability (complementary)\n```","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:19.662Z","updated_at":"2026-01-28T10:42:14.564231+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-6"}
{"id":"oep-wjtz6m","title":"Add devenv/direnv local fish autocomplete loading","description":"Load fish autocompletions from devenv/direnv. Depends on fish autocomplete support.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.419Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-8","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-x2sjpj","title":"Add fish autocompletions for mono","description":"## Problem\n\nThe `mono` CLI lacks fish shell autocompletions, making it harder to discover and use commands efficiently.\n\n## Current State\n\n* `mono`, `genie`, and `dotdot` CLIs all support `--completions fish` flag\n* Running `mono --completions fish` outputs valid fish completion script\n* Completions are not installed by default in the devenv shell\n\n## Technical Details\n\nThe CLIs use a common completion generation pattern:\n\n```bash\nmono --completions fish \u003e ~/.config/fish/completions/mono.fish\ngenie --completions fish \u003e ~/.config/fish/completions/genie.fish\ndotdot --completions fish \u003e ~/.config/fish/completions/dotdot.fish\n```\n\n## Proposed Solution\n\n1. Add completion generation to the Nix build for each CLI\n2. Use `pkgs.runCommand` pattern (like bd completions in fish.nix)\n3. Install completions to appropriate location via home-manager\n\n## Example Implementation\n\n```nix\nmonoFishCompletions = pkgs.runCommand \"mono-fish-completions\" { } ''\n  ${mono}/bin/mono --completions fish \u003e $out\n'';\n```\n\n## Related Issues\n\n* oep-f8jtec: Devenv-local completion loading (complementary approach)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T09:46:20.821Z","updated_at":"2026-01-28T10:42:14.564227+01:00","external_ref":"https://linear.app/overengineering/issue/OEP-9"}
{"id":"oep-xsxys3","title":"Fix patches feature propagation in genie","description":"Currently no good way to enforce dependents of a package with patches to also have patches in their package.json.genie.ts. Blocked by bun bug.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T09:46:18.742Z","updated_at":"2026-01-20T14:18:00.735381+01:00","external_ref":"https://linear.app/overengineering/issue/EU-1","deleted_at":"2026-01-20T14:18:00.735381+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"oep-zsl","title":"Ship PR #996: Adopt effect-utils megarepo patterns","description":"Epic tracking all remaining work to land PR #996 (refactor/genie-igor-ci). PR: https://github.com/livestorejs/livestore/pull/996","status":"open","priority":1,"issue_type":"epic","owner":"schickling.j@gmail.com","created_at":"2026-02-06T22:06:52.234173015+01:00","created_by":"Johannes Schickling","updated_at":"2026-02-06T22:06:52.234173015+01:00","external_ref":"gh-996"}
